# VPS Foundation Fail2ban Configuration
# Generated by Ansible - do not edit manually

[DEFAULT]
bantime = {{ vps_fail2ban_default_bantime }}
findtime = {{ vps_fail2ban_default_findtime }}
maxretry = {{ vps_fail2ban_default_maxretry }}
backend = systemd

{% for jail_name, jail_config in vps_fail2ban_jails.items() %}
[{{ jail_name }}]
enabled = {{ jail_config.enabled | ternary('true', 'false') }}
{% if jail_config.port is defined %}
port = {{ jail_config.port }}
{% endif %}
{% if jail_config.filter is defined %}
filter = {{ jail_config.filter }}
{% endif %}
{% if jail_config.logpath is defined %}
logpath = {{ jail_config.logpath }}
{% endif %}
{% if jail_config.maxretry is defined %}
maxretry = {{ jail_config.maxretry }}
{% endif %}
{% if jail_config.bantime is defined %}
bantime = {{ jail_config.bantime }}
{% endif %}

{% endfor %}
